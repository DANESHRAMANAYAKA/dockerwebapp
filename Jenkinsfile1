pipeline {
    agent any
    stages {
        stage("Create tmp YAML file"){
            steps{
                sh 'cp deployment-definition.yml deployment-definition-tmp.yml'  
            }
        }
        stage('Read YAML file') {
            steps{
            echo 'Starting Read YAML file '
            script{ datas = readYaml (file: 'deployment-definition-tmp.yml') }
            echo "This is full file"      
            echo datas.toString()
            echo "This is a image"
            echo datas.spec.template.spec.containers.image.toString()
            
           //datas.spec.template.spec.containers.image = "applicationVersion"
           //echo datas.spec.template.spec.containers.image.toString()
           //////////////////////
           
           mydata = readYaml file: "deployment-definition-tmp.yml"
           //modify
           //mydata.info = "b"
           //writeYaml file: 'newtest.yaml', data: mydata
           
           
           /////////////////////

            

            }
        
        }
        stage('Build image') {
            steps {
                echo 'Starting to build docker image'

                script {
                    def customImage = docker.build("dockerwebapp")
                  
                }
            }
        }
    }
}
